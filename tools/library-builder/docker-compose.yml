# Library Builder â€” Docker Compose
#
# Builds index.json for a folder of STL/3MF files, optionally running each
# model through OrcaSlicer to extract filament weight and estimated print time.
#
# Usage:
#   1. Set env vars (or create a .env file):
#        MODELS_DIR   - host path to your STL/3MF folder  (default: ./models)
#        PROFILES_DIR - host path to OrcaSlicer profiles   (default: ./profiles)
#   2. Export your OrcaSlicer print profile as a .json file into PROFILES_DIR
#   3. Run:
#        docker compose run --rm library-builder \
#          /models --slicer-config /profiles/my-profile.json --non-interactive --color blue
#
# Without --slicer-config the tool runs normally (no slicing, no filament/time data).
#
# Update the image:
#   docker compose build --no-cache

services:
  library-builder:
    build: .
    volumes:
      - ${MODELS_DIR:-./models}:/models
      - ${PROFILES_DIR:-./profiles}:/profiles
    environment:
      - PYTHONUNBUFFERED=1
